<!DOCTYPE html>
<html>
  <head>
    <title>TV Manager API</title>
    <meta charset='utf-8'>
    <script src='https://www.w3.org/Tools/respec/respec-w3c-common'
            async class='remove'></script>
    <script class="remove">
      var respecConfig = {
        specStatus:          "unofficial", // "ED",
        shortName:           "TV Manager API", // needed for generated URLs
        editors: [{
          name: "Gene Lian",
          company: "Mozilla",
          companyURL: "http://www.mozilla.org",
          mailto: "clian@mozilla.com"
        }],
        publishDate:         "", // no needed for "ED" or "unofficial"
        edDraftURI:          "http://airpingu.github.io/tv-tuner-api/index.html", // needed for "ED"
        previousPublishDate: "", // needed for "WD", "LC", "CR"
        previousMaturity:    "", // needed for "WD", "LC", "CR"
        lcEnd:               "", // needed for "LC"
        crEnd:               "", // needed for "CR"
        // wg:           "System Applications Working Group",
        // wgURI:        "http://www.w3.org/2012/sysapps/",
        // wgPublicList: "public-sysapps",
        // wgPatentURI:  "http://www.w3.org/2004/01/pp-impl/43696/status",
        otherLinks: [{
          key: "Repository",
          data: [{
            value: "We are on GitHub.",
            href: "https://github.com/airpingu/tv-tuner-api/"
          }, {
            value: "File a bug.",
            href: "https://github.com/airpingu/tv-tuner-api/issues"
          }, {
            value: "Commit history.",
            href: "https://github.com/airpingu/tv-tuner-api/commits/gh-pages"
          }]
        }],
        inlineCSS:    true,
        noIDLIn:      true,
        noIDLSorting: true
      };
    </script>
  </head>

<!-----------------------------------------------------------------------------
Style guide to contributors:
============================
- this document uses ReSpec, see
  http://dev.w3.org/2009/dap/ReSpec.js/documentation.html
- use 80 characters wide lines, whenever possible (except long links)
- keep sections 2 empty lines apart
- put comments in front of sections, for better readability with syntax coloring
  editors
- use indentation with care: it may improve readability, but at the expense of
  line lenght
- when descriptions of attributes is short, use the <dd> elements even when
  the text also contains conformance statements (e.g. MUST, SHOULD, MAY).
  No use repeating the same information in a separate paragraph.
------------------------------------------------------------------------------>
 
  <body>

<!-- - - - - - - - - - - - - - - Abstract  - - - - - - - - - - - - - - - - - -->    
    <section id="abstract">
      The TV Manager API allows an application to manage the TV device.
    </section>

<!-- - - - - - - - - - - - - - - Status of this document - - - - - - - - - - -->   
    <section id="sotd">
    </section>
    
<!-- - - - - - - - - - - - - - - Introduction  - - - - - - - - - - - - - - - -->
    <section class="informative">
      <h2>Introduction</h2>
      <p>
        The TV Manager API interfaces provide a bunch of properties and a set of
        operations to allow Web applications to acquire the information of TV
        sources, TV channels and TV programs as well as to manage the native TV
        hardwares (i.e., TV tuners) or the TV Web services.
      </p>

      <section>
        <h3>User Cases</h3>
        <p>
          The TV Manager API is aimed to cover the following user cases:
        </p>
        <ul>
          <li>
            The web content is able to control the TV channel of the TV device
            with the TV tuner.
          </li>
          <li>
            One TV can have multiple TV tuners. For example, one is for watching
            TV and the other is for recording.
          </li>
          <li>
            TV Tuner can scan broadcasting channels, where each TV tuner can
            have its own scanning algorithm provided by the vendor.
          </li>
          <li>
            Web content needs to know which broadcasting types are supported by
            the TV tuners.
          </li>
          <li>
            Web content needs to know the information of Electronic Program
            Guide (EPG) that is being broadcasted.
          </li>
          <li>
            Users can navigate through the EPG and selects a program to watch.
          </li>
          <li>
            Users can watch the broadcasting program while browsing through the
            list of other programs that are currently broadcasted.
          </li>
          <li>
            Web content needs to know if the currently displayed TV channel has
            bad or no signal. Can be covered by VideoElement?
          </li>
          <li>
            One TV channel can have multiple video/audio tracks in the
            same broadcasting stream.
          </li>
          <li>
            Emergency broadcasting for earthquake, tsunami... etc.
          </li>
          <li>
            In the first step, only certified apps are allowed to use the TV
            Manager API.
          </li>
          <li>
            The DTV can keep track of the multiple TV tuners that a TV channel
            can belong to, so that web content can do more flexible services
            like: when the user is using the TV tuner A to watch and record a
            certain TV channel at the same time, supposing the user wants to
            switch to other channels to watch, the DTV should use the TV tuner
            B to switch channels so that it won't stop the original recording
            task on the TV tuner A.
          </li>
          <li>
            EPG can be dynamically updated by the broadcasters. We need a way
            to notify the web contents to update its EPG menu from time to time.
          </li>
          <li>
            It is necessary to support multiple channels that can be
            concurrently displayed on the TV (i.e. Picture-in-Picture).
          </li>
          <li>
            DTV needs to connect to the broadcasters' remote servers to provide
            more TV services through the Web. To do this, the web content needs
            a universal way to identify the TV program.
          </li>
        </ul>
      </section>

      <section>
        <h3>Examples</h3>
        <p>
          If an application has the privilege to use the TV Manager API, it can
          use a bunch of basic methods defined in the <a>TVManager</a> to
          manage the TV device.
        </p>

        <p>
          The following example shows how to get all the TV tuners that are
          currently available on the TV device and how to listen to the events
          for the TV tuner changes.
        </p>

        <pre class="example highlight">
          // An array which saves all the currently available TV tuners.
          var curTuners = [];

          // Set the 'ontunerchanged' event handler.
          navigator.mozTV.ontunerchanged = function ontunerchanged(event) {
            var operation = event.operation;
            var changedTuner = event.tuner;

            switch (operation) {
              case "added":
                curTuners.push(changedTuner);
                break;
              case "removed":
                curTuners.some(function findTuner(tuner, index) {
                  if (tuner.id == changedTuner.id) {
                    curTuners.splice(index, 1);
                    return true;
                  }
                  return false;
                });
                break;
              case "configured":
                curTuners.some(function findTuner(tuner, index) {
                  if (tuner.id == changedTuner.id) {
                    curTuners[index] = changedTuner;
                    return true;
                  }
                  return false;
                });
                break;
              default:
                break;
            }
          };

          // Retrieve all the currently available TV tuners.
          navigator.mozTV.getTuners().then(function onsuccess(tuners) {
            curTuners = tuners;
          }, function onerror(error) {
            alert(error);
          });
        </pre>

        <p>
          The following example shows how to get all the TV channels that are
          currently available in the currently configured TV source of a TV
          tuner and how to listen to the events for the TV channel changes.
        </p>

        <pre class="example highlight">
          // A matrix which maps the TV tuner to its corresponding array of TV
          // channels in the currenly configured TV source.
          // E.g., { "tunerId1": [...], "tunerId2": [...] }.
          var curChannelsOfTuners = {};

          // Set the 'onchannelconfigured' event handler.
          navigator.mozTV.onchannelconfigured = function onchannelconfigured(event) {
            var configuredChannel = event.channel;

            var channels = curChannelsOfTuners[configuredChannel.source.tuner.id];
            if (channels) {
              channels.some(function findChannel(channel, index) {
                var channelId = channel.id;

                if (channelId == configuredChannel.id) {
                  channels[index] = configuredChannel;
                  return true;
                }
                return false;
              });
            }
          };

          // Retrieve all the currently available TV tuners in the TV device.
          navigator.mozTV.getTuners().then(function onsuccess(tuners) {
            tuners.forEach(function getChannelsByTuner(tuner) {
              var tunerId = tuner.id;
              var currentSource = tuner.currentSource;

              if (!currentSource) {
                return;
              }

              // Set the 'onscanningstatechanged' event handler.
              currentSource.onscanningstatechanged = function onscanningstatechanged(event) {
                var state = event.state;
                var scannedChannel = event.channel;

                switch (state) {
                  case "cleared":
                    if (curChannelsOfTuners[tunerId]) {
                      delete curChannelsOfTuners[tunerId];
                    }
                    break;
                  case "scanned":
                    var channels = curChannelsOfTuners[tunerId];
                    if (channels) {
                      channels.push(scannedChannel);
                    } else {
                      curChannelsOfTuners[tunerId] = [scannedChannel];
                    }
                    break;
                  default:
                    break;
                }
              };

              // Retrieve all the currently available TV channels that are
              // currently available in the currently configured TV source of
              // the TV tuner.
              navigator.mozTV.getChannels({
                sourceId: currentSource.id
              }).then(function onsuccess(channels) {
                curChannelsOfTuners[tunerId] = channels;
              }, function onerror(error) {
                alert(error);
              });
            });
          }, function onerror(error) {
            alert(error);
          });
        </pre>

        <p>
          The following example shows how to get all the TV programs that are
          currently available in the TV channel and how to listen to the events
          for the TV program changes.
        </p>

        <pre class="example highlight">
          // A matrix which maps the TV channel to its corresponding array of TV
          // programs (i.e., EPG). E.g., { "channelId1": [...], "channelId2": [...] }.
          var curProgramsOfChannels = {};

          // Retrieve all the currently available TV tuners in the TV device.
          navigator.mozTV.getTuners().then(function onsuccess(tuners) {
            if (tuners.length == 0) {
              return;
            }

            // Just use the first TV tuner.
            var tuner = tuners[0];
            var currentSource = tuner.currentSource;

            if (!currentSource) {
              return;
            }

            // Set the 'oneitbroadcasted' event handler.
            currentSource.oneitbroadcasted = function oneitbroadcasted(event) {
              var newPrograms = event.programs;

              // Flush the EPG because a new EIT is broadcasted by TV source.
              curProgramsOfChannels = {};

              newPrograms.forEach(function addProgram(program) {
                var channelId = program.channel.id;

                var programs = curProgramsOfChannels[channelId];
                if (programs) {
                  programs.push(program);
                } else {
                  curProgramsOfChannels[channelId] = [program];
                }
              });
            };

            // Retrieve all the currently available TV channels in the currently
            // configured TV source of the TV tuner.
            navigator.mozTV.getChannels({
              sourceId: currentSource.id
            }).then(function onsuccess(channels) {
              channels.forEach(function getProgramsByChannel(channel) {
                var channelId = channel.id;

                // Retrieve all the currently available TV programs in the TV
                // channel.
                navigator.mozTV.getPrograms({
                  channelId: channelId
                }).then(function onsuccess(programs) {
                  curProgramsOfChannels[channelId] = programs;
                }, function onerror(error) {
                  alert(error);
                });
              });
            }, function onerror(error) {
              alert(error);
            });
          });
        </pre>

        <p>
          The following example shows how to play the <code>MediaStream</code>
          of a TV source by assigning the <code>MediaStream</code> to a
          <code>HTMLMediaElement</code>.
        </p>

        <pre class="example highlight">
          &lt;!DOCTYPE html&gt;
          &lt;html&gt;
            &lt;head&gt;
              &lt;script&gt;
                // Retrieve all the currently available TV tuners first.
                navigator.mozTV.getTuners().then(function onsuccess(tuners) {
                  if (tuners.length == 0) {
                    return;
                  }

                  // Just use the first TV tuner.
                  var tuner = tuners[0];

                  var video = document.getElementById("video-player");
                  video.srcObject = tuner.stream;
                }, function onerror(error) {
                  alert(error);
                });
              &lt;/script&gt;
            &lt;/head&gt;
            &lt;body&gt;
              &lt;p&gt;&lt;video id="video-player" autoplay&gt;&lt;/video&gt;&lt;/p&gt;
            &lt;/body&gt;
          &lt;/html&gt;
        </pre>

        <p>
          The following example shows how to scan and get all the TV channels
          that are available in the currenly configured TV source of the TV
          tuner.
        </p>

        <pre class="example highlight">
          // Retrieve all the currently available TV tuners in the TV device.
          navigator.mozTV.getTuners().then(function onsuccess(tuners) {
            if (tuners.length == 0) {
              return;
            }

            // Just use the first TV tuner.
            var tuner = tuners[0];
            var currentSource = tuner.currentSource;

            if (!currentSource) {
              return;
            }

            // Set the 'onscanningstatechanged' event handler.
            currentSource.onscanningstatechanged = function onscanningstatechanged(event) {
              var state = event.state;
              var scannedChannel = event.channel;

              switch (state) {
                case "cleared":
                  alert("All the TV channels are cleared for rescanning.");
                  break;
                case "scanned":
                  alert("A new TV channel is scanned: " + scannedChannel.name);
                  break;
                case "completed":
                  alert("The scanning process is completed.");
                  break;
                case "stopped":
                  alert("The scanning process is stopped.");
                  break;
                default:
                  break;
              }
            };

            if (currentSource.isScanning) {
              return;
            }

            var currentSourceId = currentSource.id;

            // Ask the currently configured TV source to scan the TV channels.
            navigator.mozTV.startScanning({
              sourceId: currentSourceId,
              isRescanned: true
            }).then(function onsuccess() {
              // Retrieve all the currently available TV channels in the
              // currently configured TV source of the TV tuner.
              navigator.mozTV.getChannels({
                sourceId: currentSourceId,
              }).then(function onsuccess(channels) {
                alert("Succeeded to scan and get all the TV channels.");
              }, function onerror(error) {
                alert(error);
              });
            }, function onerror(error) {
              alert(error);
            });
          });
        </pre>

        <p>
          The following example shows how to tune the TV channel by the TV
          channel ID.
        </p>

        <pre class="example highlight">
          // Retrieve all the currently available TV tuners.
          navigator.mozTV.getTuners().then(function onsuccess(tuners) {
            if (tuners.length == 0) {
              return;
            }

            // Just use the first TV tuner.
            var tuner = tuners[0];
            var currentSource = tuner.currentSource;

            if (!currentSource) {
              return;
            }

            // Retrieve all the currently available TV channels in the currently
            // configured TV source of the TV tuner.
            navigator.mozTV.getChannels({
              sourceId: currentSource.id;
            }).then(function onsuccess(channels) {
              if (channels.length == 0) {
                return;
              }

              // Just use the first TV channel.
              var channel = channels[0];

              // Tune the TV channel based on the TV channel ID.
              navigator.mozTV.tuneChannel({
                channelId: channel.id
              }).then(function onsuccess() {
                alert("Succeeded to tune the TV channel.");
              }, function onerror(error) {
                alert(error);
              });
            }, function onerror(error) {
              alert(error);
            });
          }, function onerror(error) {
            alert(error);
          });
        </pre>

        <p>
          The following example shows how to unlock the parental control.
        </p>

        <pre class="example highlight">
          // Retrieve all the currently available TV tuners.
          navigator.mozTV.getTuners().then(function onsuccess(tuners) {
            if (tuners.length == 0) {
              return;
            }

            // Just use the first TV tuner.
            var tuner = tuners[0];
            var currentSource = tuner.currentSource;

            if (!currentSource) {
              return;
            }

            // This event handler will be triggered when the TV channel is tuned.
            currentSource.oncurrentchannelchanged = function oncurrentchannelchanged(event) {
              var changedCurrentChannel = event.channel;

              if (navigator.mozTV.isParentalControlLocked &&
                  changedCurrentChannel.isParentalControlProtected) {
                // If the parental control is locked and the currently tuned TV
                // channel is protected, the |tuner.stream|'s media tracks will
                // be disabled (i.e. black screen). The UA can pop up a prompt
                // to ask the user to enter the password to unlock it.
                alert("Parental control is locked. Please enter the password.");

                // Unlock the parental control which will be applied system-wisely.
                navigator.mozTV.unlockParentalControl().then(function onsuccess() {
                  alert("Parental control is unlocked until the next reboot.");
                }, function onerror(error) {
                  alert(error);
                });
              }
            };

            // Retrieve all the currently available TV channels in the currently
            // configured TV source of the TV tuner.
            navigator.mozTV.getChannels({
              sourceId: currentSource.id;
            }).then(function onsuccess(channels) {
              if (channels.length == 0) {
                return;
              }

              // Just use the first TV channel.
              var channel = channels[0];

              // Tune the TV channel based on the TV channel ID.
              navigator.mozTV.tuneChannel({
                channelId: channel.id
              }).then(function onsuccess() {
                alert("Succeeded to tune the TV channel.");
              }, function onerror(error) {
                alert(error);
              });
            }, function onerror(error) {
              alert(error);
            });
          }, function onerror(error) {
            alert(error);
          });
        </pre>
      </section>
    </section>
    
<!-- - - - - - - - - - - - - - - Conformance - - - - - - - - - - - - - - - - -->
    <section id="conformance">
      <p>
        This specification defines conformance criteria that apply to a single
        product: the <dfn>user agent</dfn> that implements the interfaces that
        it contains.
      </p>
    
      <p>
        Implementations that use ECMAScript to implement the APIs defined in
        this specification MUST implement them in a manner consistent with the
        ECMAScript Bindings defined in the Web IDL specification [[!WEBIDL]], as
        this specification uses that specification and terminology.
      </p>
    </section>
    
<!-- - - - - - - - - - - - - - - Terminology  - - - - - - - - - - - - - - - -->
    <section>
      <h2>Terminology</h2>
      <p>
        The <dfn><a
        href="http://dev.w3.org/html5/spec/webappapis.html#eventhandler">
        EventHandler</a></dfn> interface represents a callback used for event
        handlers as defined in [[!HTML5]].
      </p>
    
      <p>
        The concepts <dfn><a
        href="http://dev.w3.org/html5/spec/webappapis.html#queue-a-task"> queue
        a task</a></dfn> and <dfn><a
        href="http://dev.w3.org/html5/spec/webappapis.html#fire-a-simple-event">
        fire an event</a></dfn> are defined in [[!HTML5]].
      </p>
    
      <p>
        The terms <a
        href="http://dev.w3.org/html5/spec/webappapis.html#event-handlers"><dfn
        id="dfn-eventhandler">event handler</dfn></a> and <a
        href="http://dev.w3.org/html5/spec/webappapis.html#event-handler-event-type">
        <dfn id="dfn-eventtypes"> event handler event types</dfn></a> are
        defined in [[!HTML5]].
      </p>
    
      <p>
        The <dfn><a href="http://dom.spec.whatwg.org/#promise">Promise</a></dfn>
        interface, the concepts of a <a href=
        "http://dom.spec.whatwg.org/#concept-resolver"><dfn>resolver</dfn></a>, a
        <dfn id="dfn-fulfill-algorithm"><a
        href="http://dom.spec.whatwg.org/#concept-resolver-fulfill"> resolver's
        fulfill algorithm</a></dfn> and a <dfn id="dfn-reject-algorithm"><a
        href="http://dom.spec.whatwg.org/#concept-resolver-reject"> resolver's
        reject algorithm</a></dfn> are defined in [[DOM4]].
      </p>
    </section>

<!-- - - - - - - - - - - - - Extended Interface Navigator  - - - - - - - - - -->
    <section>
      <h2><a>Navigator</a> Interface</h2>
        <dl title="partial interface Navigator" class="idl">
          <dt>readonly attribute TVManager mozTV</dt>
          <dd>
          MUST return the object that exposes the interface to the TV service.
          </dd>
      </dl>
    </section>

<!-- - - - - - - - - - - - - Interface TVManager  - - - - - - - - - - - - - -->
    <section>
      <h2><a>TVManager</a> Interface</h2>
      <p>
        The <a>TVManager</a> interface represents a bunch of properties and
        a set of operations that can be used to manage the TV device.
      </p>

      <dl title="interface TVManager : EventTarget" class="idl">
        <dt>Promise getTuners ()</dt>
          <dd>
            This method makes a request to retrieve all the TV tuners that are
            available in the TV device. It returns a new <code>Promise</code>
            that will be used to notify the caller about the result of the
            operation, which is an array of <a>TVTuner</a> elements.
          </dd>

        <dt>Promise configureTuner ()</dt>
          <dd>
            This method makes a request to configure the TV tuner by the
            <code>options</code> parameter. It returns a new
            <code>Promise</code> that will be used to notify the caller about
            the result of the operation.
            <dl class='parameters'>
              <dt>TVConfigureTunerOptions options</dt>
                <dd>
                  Specifies the options for configuring the TV tuner.
                </dd>
            </dl>
          </dd>

        <dt>Promise getSources ()</dt>
          <dd>
            This method makes a request to retrieve all the TV sources that are
            available in the TV tuner(s) by the <code>options</code> parameter.
            It returns a new <code>Promise</code> that will be used to notify
            the caller about the result of the operation, which is an array of
            <a>TVSource</a> elements that belong to the TV tuner(s).
            <dl class='parameters'>
              <dt>optional TVGetSourcesOptions options</dt>
                <dd>
                  Specifies the options for retrieving the TV sources. If the
                  <code>tunerId</code> option in the <code>options</code>
                  parameter is not passed, this method will return all the TV
                  sources that are available across different TV tuners.
                </dd>
            </dl>
          </dd>

        <dt>Promise getChannels ()</dt>
          <dd>
            This method makes a request to retrieve all the TV channels that are
            available in the TV source(s) by the <code>options</code> parameter.
            It returns a new <code>Promise</code> that will be used to notify
            the caller about the result of the operation, which is an array of
            <a>TVChannel</a> elements that belong to the TV source(s).
            <dl class='parameters'>
              <dt>optional TVGetChannelsOptions options</dt>
                <dd>
                  Specifies the options for retrieving the TV channels. If the
                  <code>sourceId</code> option in the <code>options</code>
                  parameter is not passed, this method will return all the TV
                  channels that are available across different TV sources.
                </dd>
            </dl>
          </dd>

        <dt>Promise configureChannel ()</dt>
          <dd>
            This method makes a request to configure the TV channel by the
            <code>options</code> parameter. It returns a new
            <code>Promise</code> that will be used to notify the caller about
            the result of the operation.
            <dl class='parameters'>
              <dt>TVConfigureChannelOptions options</dt>
                <dd>
                  Specifies the options for configuring the TV channel.
                </dd>
            </dl>
          </dd>

        <dt>Promise getPrograms ()</dt>
          <dd>
            This method makes a request to retrieve all the TV programs that are
            available in the TV channel(s) by the <code>options</code>
            parameter. It returns a new <code>Promise</code> that will be used
            to notify the caller about the result of the operation, which is an
            array of <a>TVProgram</a> elements that belong to the TV channel(s).
            <dl class='parameters'>
              <dt>optional TVGetProgramsOptions options</dt>
                <dd>
                  Specifies the options for retrieving the TV programs. If the
                  <code>channelId</code> option in the <code>options</code>
                  parameter is not passed, this method will return all the TV
                  programs that are available across different TV channels.
                </dd>
            </dl>
          </dd>

        <dt>Promise startScanning ()</dt>
          <dd>
            This method makes a request to start scanning all the TV channels
            that are available in the TV source(s) by the <code>options</code>
            parameter. It returns a new <code>Promise</code> that will be used
            to notify the caller about the result of the operation. Note that
            this method has to be called first so that the method
            <a><code>getChannels</code></a> can retrieve the channels that have
            successfully been scanned by the TV source(s).
            <dl class='parameters'>
              <dt>optional TVStartScanningOptions options</dt>
                <dd>
                  Specifies the options for scanning the TV channels. The
                  <code>sourceId</code> option in the <code>options</code>
                  specifies how the TV source starts scanning. If it is not
                  passed, this method will start scanning all the TV channels
                  that are available across different TV sources. The
                  <code>isRescanned</code> option in the <code>options</code>
                  parameter specifies whether or not the process of scanning the
                  TV channels has to clear the currently scanned TV channels
                  before scanning. If it is not passed, this method will rescan
                  all the TV channels as if it is passed as <code>true</code>.
                </dd>
            </dl>
          </dd>

        <dt>Promise stopScanning ()</dt>
          <dd>
            This method makes a request to stop scanning the TV channels for the
            TV source(s) by the <code>options</code> parameter. It returns a new
            <code>Promise</code> that will be used to notify the caller about
            the result of the operation.
            <dl class='parameters'>
              <dt>optional TVStopScanningOptions options</dt>
                <dd>
                  Specifies the options for stopping scanning the TV channels.
                  The <code>sourceId</code> option in the <code>options</code>
                  specifies which TV source stops scanning. If it is not passed,
                  this method will stop scanning for all the TV sources.
                </dd>
            </dl>
          </dd>

        <dt>Promise tuneChannel ()</dt>
          <dd>
            This method makes a request to tune the TV channel by the
            <code>options</code> parameter. It returns a new
            <code>Promise</code> that will be used to notify the caller about
            the result of the operation.
            <dl class='parameters'>
              <dt>TVTuneChannelOptions options</dt>
                <dd>
                  Specifies the options for tuning the TV channel.
                </dd>
            </dl>
          </dd>

        <dt>Promise unlockParentalControl ()</dt>
          <dd>
            This method makes a request to unlock the parental control by
            popping up a prompt to ask the user to input the correct password.
            Once the parental control is unlocked, it won't be locked until the
            next reboot. It returns a new <code>Promise</code> that will be used
            to notify the caller about the result of the operation.
          </dd>

        <dt>readonly attribute boolean isParentalControlLocked</dt>
          <dd>
            MUST return the current lock state of the TV parental control, which
            is system-widely applied to the TV device (i.e., once the parental
            control is unlocked, all the protected TV channels/programs will be
            unlocked until the next reboot).
          </dd>

        <dt class="no-docs">
          attribute EventHandler ontunerchanged
        </dt>
          <dd>
            Handles the <code>ontunerchanged</code> event of type
            <a>TVTunerChangedEvent</a>, fired when a TV tuner is added/removed
            by the TV device or configured by the Web application, where the
            former is fired when the TV device detects a TV tuner is
            added/removed and the latter only happens when the method
            <a><code>configureTuner</code></a> is invoked to configure the TV
            tuner.
          </dd>

        <dt class="no-docs">
          attribute EventHandler onchannelconfigured
        </dt>
          <dd>
            Handles the <code>onchannelconfigured</code> event of type
            <a>TVChannelConfiguredEvent</a>, fired when a TV channel is
            configured by the Web application, which only happens when the
            method <a><code>configureChannel</code></a> is invoked to configure
            the TV channel.
          </dd>

        <dt class="no-docs">
          attribute EventHandler onparentalcontrolchanged
        </dt>
          <dd>
            Handles the <code>onparentalcontrolchanged</code> event of type
            <a>TVParentalControlChangedEvent</a>, fired when the state of the TV
            parental control is changed, which only happens when the method
            <a><code>unlockParentalControl</code></a> is invoked to unlock the
            parental control.
          </dd>
      </dl>

      <section>
        <h3>Steps</h3>

        <p>
          The <dfn><code>getTuners</code></dfn> method when invoked MUST run
          the following steps:
        </p>
        <ol>
          <li>
            Let <var>promise</var> be a new <code>Promise</code> object and
            <var>resolver</var> be its associated <code>resolver</code>.
          </li>
          <li>
            Return <var>promise</var> to the caller.
          </li>
          <li>
            Make a request to the TV device to retrieve all the TV tuners that
            are available in the TV device.
          </li>
          <li>
            If an <var>error</var> occurs invoke <em>resolver</em>'s <a
            class="internalDFN" href="#dfn-reject-algorithm">reject algorithm</a>
            with <em>error</em> as the <code>value</code> argument.
          </li>
          <li>
            When the request has been successfully completed:
          </li>
          <ol>
            <li>
              Let <var>tuners</var> be the array of the retrieved <a>TVTuner</a>
              elements.
            </li>
            <li>
              Invoke <em>resolver</em>'s <a
              class="internalDFN" href="#dfn-fulfill-algorithm"> fulfill algorithm</a>
              with <em>tuners</em> as the <code>value</code> argument.
            </li>
          </ol>
        </ol>

        <p>
          The <dfn><code>configureTuner</code></dfn> method when invoked MUST
          run the following steps:
        </p>
        <ol>
          <li>
            Let <var>promise</var> be a new <code>Promise</code> object and
            <var>resolver</var> be its associated <code>resolver</code>.
          </li>
          <li>
            Return <var>promise</var> to the caller.
          </li>
          <li>
            Make a request to the TV device to configure the TV tuner according
            to the configuring options specified in the <code>options</code>
            parameter.
          </li>
          <li>
            If an <var>error</var> occurs invoke <em>resolver</em>'s <a
            class="internalDFN" href="#dfn-reject-algorithm">reject algorithm</a>
            with <em>error</em> as the <code>value</code> argument.
          </li>
          <li>
            When the request has been successfully completed:
          </li>
          <ol>
            <li>
              Invoke <em>resolver</em>'s <a
              class="internalDFN" href="#dfn-fulfill-algorithm"> fulfill algorithm</a>
              without assigning a value to the <code>value</code> argument.
            </li>
          </ol>
        </ol>

        <p>
          The <dfn><code>getSources</code></dfn> method when invoked MUST run
          the following steps:
        </p>
        <ol>
          <li>
            Let <var>promise</var> be a new <code>Promise</code> object and
            <var>resolver</var> be its associated <code>resolver</code>.
          </li>
          <li>
            Return <var>promise</var> to the caller.
          </li>
          <li>
            Make a request to the TV tuner(s) to retrieve all the TV sources
            that are available in the TV tuner(s) according to the retrieving
            options specified in the <code>options</code> parameter. If the
            the <code>tunerId</code> option in the <code>options</code>
            parameter is not passed, retrieve all the TV sources that are
            available across different TV tuners.
          </li>
          <li>
            If an <var>error</var> occurs invoke <em>resolver</em>'s <a
            class="internalDFN" href="#dfn-reject-algorithm">reject algorithm</a>
            with <em>error</em> as the <code>value</code> argument.
          </li>
          <li>
            When the request has been successfully completed:
          </li>
          <ol>
            <li>
              Let <var>sources</var> be the array of the retrieved
              <a>TVSource</a> elements.
            </li>
            <li>
              Invoke <em>resolver</em>'s <a
              class="internalDFN" href="#dfn-fulfill-algorithm"> fulfill algorithm</a>
              with <em>channels</em> as the <code>value</code> argument.
            </li>
          </ol>
        </ol>

        <p>
          The <dfn><code>getChannels</code></dfn> method when invoked MUST run
          the following steps:
        </p>
        <ol>
          <li>
            Let <var>promise</var> be a new <code>Promise</code> object and
            <var>resolver</var> be its associated <code>resolver</code>.
          </li>
          <li>
            Return <var>promise</var> to the caller.
          </li>
          <li>
            Make a request to the TV source(s) to retrieve all the TV channels
            that are available in the TV source(s) according to the retrieving
            options specified in the <code>options</code> parameter. If the
            <code>sourceId</code> option in the <code>options</code> parameter
            is not passed, retrieve all the TV channels that are available
            across different TV sources.
          </li>
          <li>
            If an <var>error</var> occurs invoke <em>resolver</em>'s <a
            class="internalDFN" href="#dfn-reject-algorithm">reject algorithm</a>
            with <em>error</em> as the <code>value</code> argument.
          </li>
          <li>
            When the request has been successfully completed:
          </li>
          <ol>
            <li>
              Let <var>channels</var> be the array of the retrieved
              <a>TVChannel</a> elements.
            </li>
            <li>
              Invoke <em>resolver</em>'s <a
              class="internalDFN" href="#dfn-fulfill-algorithm"> fulfill algorithm</a>
              with <em>channels</em> as the <code>value</code> argument.
            </li>
          </ol>
        </ol>

        <p>
          The <dfn><code>configureChannel</code></dfn> method when invoked MUST
          run the following steps:
        </p>
        <ol>
          <li>
            Let <var>promise</var> be a new <code>Promise</code> object and
            <var>resolver</var> be its associated <code>resolver</code>.
          </li>
          <li>
            Return <var>promise</var> to the caller.
          </li>
          <li>
            Make a request to the TV source to configure the TV channel
            according to the configuring options specified in the
            <code>options</code> parameter.
          </li>
          <li>
            If an <var>error</var> occurs invoke <em>resolver</em>'s <a
            class="internalDFN" href="#dfn-reject-algorithm">reject algorithm</a>
            with <em>error</em> as the <code>value</code> argument.
          </li>
          <li>
            When the request has been successfully completed:
          </li>
          <ol>
            <li>
              Invoke <em>resolver</em>'s <a
              class="internalDFN" href="#dfn-fulfill-algorithm"> fulfill algorithm</a>
              without assigning a value to the <code>value</code> argument.
            </li>
          </ol>
        </ol>

        <p>
          The <dfn><code>getPrograms</code></dfn> method when invoked
          MUST run the following steps:
        </p>
        <ol>
          <li>
            Let <var>promise</var> be a new <code>Promise</code> object and
            <var>resolver</var> be its associated <code>resolver</code>.
          </li>
          <li>
            Return <var>promise</var> to the caller.
          </li>
          <li>
            Make a request to the TV channel(s) to retrieve all the TV programs
            that are available in the TV channel(s) according to the retrieving
            options specified in the <code>options</code> parameter. If the
            <code>channelId</code> option in the <code>options</code> parameter
            is not passed, retrieve all the TV programs that are available
            across different TV channels. Needs to add more descriptions for
            other options...
          </li>
          <li>
            If an <var>error</var> occurs invoke <em>resolver</em>'s <a
            class="internalDFN" href="#dfn-reject-algorithm">reject algorithm</a>
            with <em>error</em> as the <code>value</code> argument.
          </li>
          <li>
            When the request has been successfully completed:
          </li>
          <ol>
            <li>
              Let <var>programs</var> be the array of the retrieved
              <a>TVProgram</a> elements.
            </li>
            <li>
              Invoke <em>resolver</em>'s <a
              class="internalDFN" href="#dfn-fulfill-algorithm"> fulfill algorithm</a>
              with <em>programs</em> as the <code>value</code> argument.
            </li>
          </ol>
        </ol>

        <p>
          The <dfn><code>startScanning</code></dfn> method when invoked MUST
          run the following steps:
        </p>
        <ol>
          <li>
            Let <var>promise</var> be a new <code>Promise</code> object and
            <var>resolver</var> be its associated <code>resolver</code>.
          </li>
          <li>
            Return <var>promise</var> to the caller.
          </li>
          <li>
            Make a request to the TV source(s) to start scanning all the TV
            channels that are available in the TV source(s) according to the
            scanning options specified in the <code>options</code> parameter. If
            the <code>sourceId</code> option in the <code>options</code>
            parameter is not passed, the
            <a class="internalDFN" href="#dfn-user-agent">user agent</a> will
            scan all the TV channels that are available across different TV
            sources. If the <code>isRescanned</code> option in the
            <code>options</code> parameter is not passed or it is passed as
            <code>true</code>, the
            <a class="internalDFN" href="#dfn-user-agent">user agent</a> has to
            clear the currently scanned TV channels before scanning; if it is
            passed as <code>false</code>, the
            <a class="internalDFN" href="#dfn-user-agent">user agent</a> will
            simply scan additional TV channels which haven't been scanned yet.
          </li>
          <li>
            If an <var>error</var> occurs invoke <em>resolver</em>'s <a
            class="internalDFN" href="#dfn-reject-algorithm">reject algorithm</a>
            with <em>error</em> as the <code>value</code> argument.
          </li>
          <li>
            When the request has been successfully completed:
          </li>
          <ol>
            <li>
              Invoke <em>resolver</em>'s <a
              class="internalDFN" href="#dfn-fulfill-algorithm"> fulfill algorithm</a>
              without assigning a value to the <code>value</code> argument.
            </li>
          </ol>
        </ol>

        <p>
          The <dfn><code>stopScanning</code></dfn> method when invoked MUST run
          the following steps:
        </p>
        <ol>
          <li>
            Let <var>promise</var> be a new <code>Promise</code> object and
            <var>resolver</var> be its associated <code>resolver</code>.
          </li>
          <li>
            Return <var>promise</var> to the caller.
          </li>
          <li>
            Make a request to the TV source(s) to stop scanning the TV channels
            according to the stopping options specified in the
            <code>options</code> parameter. If the <code>sourceId</code> option
            in the <code>options</code> parameter is not passed, the
            <a class="internalDFN" href="#dfn-user-agent">user agent</a> will
            stop scanning all the TV channels for all the TV sources.
          </li>
          <li>
            If an <var>error</var> occurs invoke <em>resolver</em>'s <a
            class="internalDFN" href="#dfn-reject-algorithm">reject algorithm</a>
            with <em>error</em> as the <code>value</code> argument.
          </li>
          <li>
            When the request has been successfully completed:
          </li>
          <ol>
            <li>
              Invoke <em>resolver</em>'s <a
              class="internalDFN" href="#dfn-fulfill-algorithm"> fulfill algorithm</a>
              without assigning a value to the <code>value</code> argument.
            </li>
          </ol>
        </ol>

        <p>
          The <dfn><code>tuneChannel</code></dfn> method when invoked MUST run
          the following steps:
        </p>
        <ol>
          <li>
            Let <var>promise</var> be a new <code>Promise</code> object and
            <var>resolver</var> be its associated <code>resolver</code>.
          </li>
          <li>
            Return <var>promise</var> to the caller.
          </li>
          <li>
            Make a request to the TV source to tune the TV channel according to
            the tuning options specified in the <code>options</code> parameter.
          </li>
          <li>
            If an <var>error</var> occurs invoke <em>resolver</em>'s <a
            class="internalDFN" href="#dfn-reject-algorithm">reject algorithm</a>
            with <em>error</em> as the <code>value</code> argument.
          </li>
          <li>
            When the request has been successfully completed:
          </li>
          <ol>
            <li>
              Invoke <em>resolver</em>'s <a
              class="internalDFN" href="#dfn-fulfill-algorithm"> fulfill algorithm</a>
              without assigning a value to the <code>value</code> argument.
            </li>
          </ol>
        </ol>

        <p>
          The <dfn><code>unlockParentalControl</code></dfn> method when invoked
          MUST run the following steps:
        </p>
        <ol>
          <li>
            Let <var>promise</var> be a new <code>Promise</code> object and
            <var>resolver</var> be its associated <code>resolver</code>.
          </li>
          <li>
            Return <var>promise</var> to the caller.
          </li>
          <li>
            Make a request to the TV device to unlock the parental control. The
            <a class="internalDFN" href="#dfn-user-agent">user agent</a> has to
            pop up a prompt to ask the user to input the password to unlock the
            parental control.
          </li>
          <li>
            If an <var>error</var> occurs invoke <em>resolver</em>'s <a
            class="internalDFN" href="#dfn-reject-algorithm">reject algorithm</a>
            with <em>error</em> as the <code>value</code> argument.
          </li>
          <li>
            When the request has been successfully completed:
          </li>
          <ol>
            <li>
              Invoke <em>resolver</em>'s <a
              class="internalDFN" href="#dfn-fulfill-algorithm"> fulfill algorithm</a>
              without assigning a value to the <code>value</code> argument.
            </li>
          </ol>
        </ol>

      </section>

      <section>
        <h2>Event handlers</h2>
        <p>The following are the <a class="internalDFN"
        href="#dfn-eventhandler">event handlers</a> (and their corresponding <a
        class="internalDFN" href="#dfn-eventtypes">event types</a>) that MUST be
        supported as attributes by the <a>TVManager</a> object.

        <table class="simple">
          <thead>
            <tr>
              <th>Event handler</th>
              <th>Event name</th>
              <th>Event type</th>
              <th>Short description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong><code>ontunerchanged</code></strong></td>
              <td><code><dfn id="dfn-change-event">tunerchanged</dfn></code></td>
              <td><a><code>TVTunerChangedEvent</code></a></td>
              <td>
                Handles the information of the TV tuner that is added/removed
                by the TV device or configured by the Web application.
              </td>
            </tr>

            <tr>
              <td><strong><code>onchannelconfigured</code></strong></td>
              <td><code><dfn id="dfn-change-event">channelconfigured</dfn></code></td>
              <td><a><code>TVChannelConfiguredEvent</code></a></td>
              <td>
                Handles the information of the TV channel that is configured by
                the Web application.
              </td>
            </tr>

            <tr>
              <td><strong><code>onparentalcontrolchanged</code></strong></td>
              <td><code><dfn id="dfn-change-event">parentalcontrolchanged</dfn></code></td>
              <td><a><code>TVParentalControlChangedEvent</code></a></td>
              <td>
                Handles the information of the changed state of the TV parental
                control.
              </td>
            </tr>
          </tbody>
        </table>
      </section>

    </section>

<!-- - - - - - - - - - - - Interface TVTuner  - - - - - - - - - - - - -->
    <section>
      <h2><a>TVTuner</a> Interface</h2>
      <p>
        The <a>TVTuner</a> interface represents a bunch of properties and
        a set of operations related to the TV tuner.
      </p>
      <dl title="interface TVTuner : EventTarget" class="idl">
        <dt>readonly attribute DOMString id</dt>
          <dd>
            MUST return the ID of the TV tuner.
          </dd>

        <dt>readonly attribute TVSourceType[] supportedSourceType</dt>
          <dd>
            MUST return the types of the supported TV sources.
          </dd>

        <dt>readonly attribute TVSource? currentSource</dt>
          <dd>
            MUST return the currenly configured TV source. MUST return
            <em>null</em> if the TV source is not yet configured.
          </dd>

        <dt>readonly attribute MediaStream? stream</dt>
          <dd>
            MUST return a <a href="http://dev.w3.org/2011/webrtc/editor/getusermedia.html#mediastream">MediaStream</a>
            object that is currently streamed by the TV source, which can be
            played by the <a href="http://dev.w3.org/html5/spec-preview/the-video-element.html#the-video-element">video</a>
            element by assigning the <code>MediaStream</code> to the
            <code>HTMLMediaElement</code> (<a href="http://dev.w3.org/2011/webrtc/editor/getusermedia.html#mediastreams-as-media-elements">
            details</a>) and can be recorded by the
            <a href="https://dvcs.w3.org/hg/dap/raw-file/tip/media-stream-capture/MediaRecorder.html#MediaRecorderAPI">MediaRecorder</a>. MUST
            return <em>null</em> if the TV tuner is not streaming any TV
            channel, which happens when the streaming signal is broken or due to
            any other reasons that the TV tuner fails to stream the TV channel.
          </dd>
      </dl>
    </section>

<!-- - - - - - - - - - - - Interface TVSource  - - - - - - - - - - - - -->
    <section>
      <h2><a>TVSource</a> Interface</h2>
      <p>
        The <a>TVSource</a> interface represents a bunch of properties and a set
        of operations related to the TV source.
      </p>
      <dl title="interface TVSource : EventTarget" class="idl">
        <dt>readonly attribute DOMString id</dt>
          <dd>
            MUST return the ID of the TV source.
          </dd>

        <dt>readonly attribute TVTuner tuner</dt>
          <dd>
            MUST return the TV tuner which the TV source belongs to.
          </dd>

        <dt>readonly attribute TVSourceType type</dt>
          <dd>
            MUST return the type of the TV source.
          </dd>

        <dt>readonly attribute boolean isScanning</dt>
          <dd>
            MUST indicate whether the TV source is scanning the TV channels or
            not.
          </dd>

        <dt>readonly attribute TVChannel? currentChannel</dt>
          <dd>
            MUST return the TV channel that is currently streamed by the TV
            tuner which owns the TV source. MUST return <em>null</em> if the TV
            tuner is not streaming any TV channel.
          </dd>

        <dt class="no-docs">
          attribute EventHandler oncurrentchannelchanged
        </dt>
          <dd>
            Handles the <code>oncurrentchannelchanged</code> event of type
            <a>TVCurrentChannelChangedEvent</a>, fired when the currently
            streamed TV channel is changed by the TV tuner which owns the TV
            source.
          </dd>

        <dt class="no-docs">
          attribute EventHandler oneitbroadcasted
        </dt>
          <dd>
            Handles the <code>oneitbroadcasted</code> event of type
            <a>TVEITBroadcastedEvent</a>, fired when the Event Information Table
            (EIT) is broadcasted by the TV source.
          </dd>

        <dt class="no-docs">
          attribute EventHandler onscanningstatechanged
        </dt>
          <dd>
            Handles the <code>onscanningstatechanged</code> event of type
            <a>TVScanningStateChangedEvent</a>, fired when the state of scanning
            the TV channels is changed by the TV source. E.g., it can be fired
            when the method <a><code>startScanning</code></a> or the method
            <a><code>stopScanning</code></a> starts or stops scanning the TV
            channels.
          </dd>
      </dl>

      <section>
        <h2>Event handlers</h2>
        <p>The following are the <a class="internalDFN"
        href="#dfn-eventhandler">event handlers</a> (and their corresponding <a
        class="internalDFN" href="#dfn-eventtypes">event types</a>) that MUST be
        supported as attributes by the <a>TVSource</a> object.

        <table class="simple">
          <thead>
            <tr>
              <th>Event handler</th>
              <th>Event name</th>
              <th>Event type</th>
              <th>Short description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong><code>oncurrentchannelchanged</code></strong></td>
              <td><code><dfn id="dfn-change-event">currentchannelchanged</dfn></code></td>
              <td><a><code>TVCurrentChannelChangedEvent</code></a></td>
              <td>
                Handles the information of the currently streamed TV channel
                that is changed by the TV tuner which owns the TV source.
              </td>
            </tr>

            <tr>
              <td><strong><code>oneitbroadcasted</code></strong></td>
              <td><code><dfn id="dfn-change-event">eitbroadcasted</dfn></code></td>
              <td><a><code>TVEITBroadcastedEvent</code></a></td>
              <td>
                Handles the information of the available TV programs in the EIT
                that is broadcasted by the TV source.
              </td>
            </tr>

            <tr>
              <td><strong><code>onscanningstatechanged</code></strong></td>
              <td><code><dfn id="dfn-change-event">scanningstatechanged</dfn></code></td>
              <td><a><code>TVScanningStateChangedEvent</code></a></td>
              <td>
                Handles the information of the state of scanning the TV
                channels, which is changed by the TV source.
              </td>
            </tr>

          </tbody>
        </table>
      </section>

    </section>

<!-- - - - - - - - - - - - Interface TVChannel  - - - - - - - - - - - - -->
    <section>
      <h2><a>TVChannel</a> Interface</h2>
      <p>
        The <a>TVChannel</a> interface represents a bunch of properties and
        a set of operations related to the TV channel.
      </p>
      <dl title="interface TVChannel : EventTarget" class="idl">
        <dt>readonly attribute DOMString id</dt>
          <dd>
            MUST return the ID of the TV channel.
          </dd>

        <dt>readonly attribute DOMString networkId</dt>
          <dd>
            MUST return the identification of a broadcast transmission network.
            On satellite and IP broadband, typically one <code>network_id</code>
            corresponds to an operator. On cable and terrestrial, where
            different radio frequencies might be used in different regions,
            operators typically use one <code>network_id</code> per such region.
          </dd>

        <dt>readonly attribute DOMString transportStreamId</dt>
          <dd>
            MUST return the identification of a time-domain multiplex of several
            programmes carried in Transport Stream (TS) packets. One or more
            multiplexes can be transmitted on any given radio frequency in a DVB
            network.
          </dd>

        <dt>readonly attribute DOMString serviceId</dt>
          <dd>
            MUST return the identification of a TV, radio or data programme
            within a TS multiplex. The number of programmes is limited by the
            capacity of the underlying physical channel.
          </dd>

        <dt>readonly attribute TVSource source</dt>
          <dd>
            MUST return the TV source which the TV channel belongs to.
          </dd>

        <dt>readonly attribute TVChannelType type</dt>
          <dd>
            MUST return the type of the TV channel.
          </dd>

        <dt>readonly attribute DOMString name</dt>
          <dd>
            MUST return the name of the TV channel. E.g., <code>"CNN"</code>,
            <code>"NHK"</code>... etc.
          </dd>

        <dt>readonly attribute DOMString number</dt>
          <dd>
            MUST return the Logical Channel Number (LCN) of the TV channel.
            E.g., <code>"12-1"</code>, <code>"12-2"</code>,
            <code>"12-2"</code>... etc.
          </dd>

        <dt>readonly attribute boolean isParentalControlProtected</dt>
          <dd>
            MUST return the current protection state of the TV parental control
            on the TV channel, which decides whether or not the TV channel is
            protected from being watched by the children.
          </dd>

        <dt>readonly attribute boolean isEmergency</dt>
          <dd>
            MUST indicate whether the TV channel is for the emergency purpose.
          </dd>

        <dt>readonly attribute boolean isFree</dt>
          <dd>
            MUST indicate whether the TV channel is free to watch.
          </dd>

        <dt>readonly attribute TVProgram? currentProgram</dt>
          <dd>
            MUST return the TV program that is currently broadcasted by the TV
            channel. MUST return <em>null</em> if the TV tuner is not streaming
            any TV channel.
          </dd>

        <dt class="no-docs">
          attribute EventHandler oncurrentprogramchanged
        </dt>
          <dd>
            Handles the <code>oncurrentprogramchanged</code> event of type
            <a>TVCurrentProgramChangedEvent</a>, fired when the currently
            broadcasted TV program is changed by the TV channel.
          </dd>

      </dl>

      <section>
        <h2>Event handlers</h2>
        <p>The following are the <a class="internalDFN"
        href="#dfn-eventhandler">event handlers</a> (and their corresponding <a
        class="internalDFN" href="#dfn-eventtypes">event types</a>) that MUST be
        supported as attributes by the <a>TVChannel</a> object.

        <table class="simple">
          <thead>
            <tr>
              <th>Event handler</th>
              <th>Event name</th>
              <th>Event type</th>
              <th>Short description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong><code>oncurrentprogramchanged</code></strong></td>
              <td><code><dfn id="dfn-change-event">currentprogramchanged</dfn></code></td>
              <td><a><code>TVCurrentProgramChangedEvent</code></a></td>
              <td>
                Handles the information of the currently broadcasted TV program
                that is changed by the TV channel.
              </td>
            </tr>
          </tbody>
        </table>
      </section>

    </section>

<!-- - - - - - - - - - - - Interface TVProgram  - - - - - - - - - - - - -->
    <section>
      <h2><a>TVProgram</a> Interface</h2>
      <p>
        The <a>TVProgram</a> interface represents a bunch of properties and
        a set of operations related to the TV program.
      </p>
      <dl title="interface TVProgram" class="idl">
        <dt>readonly attribute DOMString eventId</dt>
          <dd>
            MUST return the event ID of the TV program.
          </dd>

        <dt>readonly attribute TVChannel channel</dt>
          <dd>
            MUST return the TV channel which the TV program belongs to.
          </dd>

        <dt>readonly attribute DOMString title</dt>
          <dd>
            MUST return the title of the TV program.
          </dd>

        <dt>readonly attribute unsigned long long startTime</dt>
          <dd>
            MUST return the start time of the TV program.
          </dd>

        <dt>readonly attribute unsigned long long duration</dt>
          <dd>
            MUST return the duration of the TV program.
          </dd>

        <dt>readonly attribute DOMString? description</dt>
          <dd>
            MUST return the description of the TV program.
          </dd>

        <dt>readonly attribute DOMString? language</dt>
          <dd>
            MUST return the language of the TV program.
          </dd>

        <dt>readonly attribute DOMString? rating</dt>
          <dd>
            MUST return the rating of the TV program.
          </dd>
      </dl>
    </section>

<!-- - - - - - - - Dictionary TVConfigureTunerOptions   - - - - - - - - - -->
    <section>
      <h2><a>TVConfigureTunerOptions</a> Dictionary</h2>
      <p>
        The <a>TVConfigureTunerOptions</a> dictionary contains the information
        for configuring the TV tuner.
      </p>
      <dl title="dictionary TVConfigureTunerOptions" class="idl">
        <dt>DOMString tunerId</dt>
          <dd>
            Identifies the TV tuner that is requested to be configured.
          </dd>

        <dt>TVSourceType sourceType</dt>
          <dd>
            Identifies the new type of the TV source that is going to be
            configured.
          </dd>
      </dl>
    </section>

<!-- - - - - - - - - - Dictionary TVConfigureChannelOptions   - - - - - - - - - -->
    <section>
      <h2><a>TVConfigureChannelOptions</a> Dictionary</h2>
      <p>
        The <a>TVConfigureChannelOptions</a> dictionary contains the information
        for configuring the TV channel.
      </p>
      <dl title="dictionary TVConfigureChannelOptions" class="idl">
        <dt>DOMString channelId</dt>
          <dd>
            Identifies the TV channel that is requested to be configured.
          </dd>

        <dt>boolean isParentalControlProtected</dt>
          <dd>
            Specifies the new value of whether or not the TV channel is going to
            be protected from being watched by the children.
          </dd>

      </dl>
    </section>

<!-- - - - - - - - - - - - Dictionary TVGetSourcesOptions   - - - - - - - -->
    <section>
      <h2><a>TVGetSourcesOptions</a> Dictionary</h2>
      <p>
        The <a>TVGetSourcesOptions</a> dictionary contains the information for
        retrieving the TV sources.
      </p>
      <dl title="dictionary TVGetSourcesOptions" class="idl">
        <dt>DOMString tunerId</dt>
          <dd>
            Identifies the TV tuner that is requested to retrieve the TV
            sources.
          </dd>
      </dl>
    </section>

<!-- - - - - - - - - - - - Dictionary TVGetChannelsOptions   - - - - - - - -->
    <section>
      <h2><a>TVGetChannelsOptions</a> Dictionary</h2>
      <p>
        The <a>TVGetChannelsOptions</a> dictionary contains the information for
        retrieving the TV channels.
      </p>
      <dl title="dictionary TVGetChannelsOptions" class="idl">
        <dt>DOMString sourceId</dt>
          <dd>
            Identifies the TV source that is requested to retrieve the TV
            channels.
          </dd>
      </dl>
    </section>

<!-- - - - - - - - - - Dictionary TVGetProgramsOptions   - - - - - - - - - -->
    <section>
      <h2><a>TVGetProgramsOptions</a> Dictionary</h2>
      <p>
        The <a>TVGetProgramsOptions</a> dictionary contains the information for
        retrieving the TV programs.
      </p>
      <dl title="dictionary TVGetProgramsOptions" class="idl">
        <dt>DOMString channelId</dt>
          <dd>
            Identifies the TV channel that is requested to retrieve the TV
            programs. If this attribute is not passed, the method will return
            all the TV programs that are available across different TV channels.
          </dd>
        <dt>unsigned long numberOfPrograms</dt>
          <dd>
            Specifies how many TV programs to be retrieved from the time point
            of now. Note that this attribute is only meaningful and considered
            when the <code>channelId</code> is passed. E.g., if this attribute
            is passed as <code>1</code>, the method will return the TV program
            that is currently broadcasted by the TV channel at this moment; if
            it is passed as <code>2</code>, the method will return the current
            and the next TV programs.
          </dd>
        <dt>unsigned long long startTime</dt>
          <dd>
            Specifies the start time of a time period which bounds the time
            slots of TV programs to be retrieved. Note that this attribute is
            only meaningful and considered when the
            <code>numberOfPrograms</code> is passed as <code>0</code> or not
            passed.
          </dd>
        <dt>unsigned long long duration</dt>
          <dd>
            Specifies the duration of a time period which bounds the time slots
            of TV programs to be retrieved. Note that this attribute is only
            meaningful and considered when the <code>numberOfPrograms</code> is
            passed as <code>0</code> or not passed.
          </dd>
      </dl>
    </section>

<!-- - - - - - - - - - - - Dictionary TVStartScanningOptions   - - - - - - - -->
    <section>
      <h2><a>TVStartScanningOptions</a> Dictionary</h2>
      <p>
        The <a>TVStartScanningOptions</a> dictionary contains the information
        for scanning the TV channels.
      </p>
      <dl title="dictionary TVStartScanningOptions" class="idl">
        <dt>DOMString sourceId</dt>
          <dd>
            Identifies the TV source that is requested to scan the TV channels.
          </dd>

        <dt>boolean isRescanned</dt>
          <dd>
            Specifies whether or not the process of scanning the TV channels has
            to clear the currently scanned TV channels before scanning.
          </dd>
      </dl>
    </section>

<!-- - - - - - - - - - - - Dictionary TVStopScanningOptions   - - - - - - - -->
    <section>
      <h2><a>TVStopScanningOptions</a> Dictionary</h2>
      <p>
        The <a>TVStopScanningOptions</a> dictionary contains the information
        for stopping scanning the TV channels.
      </p>
      <dl title="dictionary TVStopScanningOptions" class="idl">
        <dt>DOMString sourceId</dt>
          <dd>
            Identifies the TV source that is requested to stop scanning the TV
            channels.
          </dd>
      </dl>
    </section>

<!-- - - - - - - - - - - - Dictionary TVTuneChannelOptions   - - - - - - - -->
    <section>
      <h2><a>TVTuneChannelOptions</a> Dictionary</h2>
      <p>
        The <a>TVTuneChannelOptions</a> dictionary contains the information for
        tuning the TV channel.
      </p>
      <dl title="dictionary TVTuneChannelOptions" class="idl">
        <dt>DOMString channelId</dt>
          <dd>
            Identifies the TV channel that is requested to be tuned.
          </dd>
      </dl>
    </section>

<!-- - - - - - - - - - Interface TVTunerChangedEvent - - - - - - - - - - -->
    <section>
      <h2><a>TVTunerChangedEvent</a> Interface</h2>
      <p>
        The <a>TVTunerChangedEvent</a> interface represents the event related
        to the TV tuner that is added/removed by the TV device or configured by
        the Web application.
      </p>
      <dl title="interface TVTunerChangedEvent : Event" class="idl">
        <dt>readonly attribute TVTunerChangedEventOperation operation</dt>
          <dd>
            MUST return the type of operation that changes the TV tuner.
          </dd>

        <dt>readonly attribute TVTuner tuner</dt>
          <dd>
            MUST return the TV tuner that is added/removed by the TV device or
            configured by the Web application.
          </dd>
      </dl>
    </section>

<!-- - - - - - - - - - - - Interface TVChannelConfiguredEvent - - - - - - - - -->
    <section>
      <h2><a>TVChannelConfiguredEvent</a> Interface</h2>
      <p>
        The <a>TVChannelConfiguredEvent</a> interface represents the event
        related to the TV channel that is configured by the Web application.
      </p>
      <dl title="interface TVChannelConfiguredEvent : Event" class="idl">
        <dt>readonly attribute TVChannel channel</dt>
          <dd>
            MUST return the TV channel that is configured by the Web
            application.
          </dd>
      </dl>
    </section>

<!-- - - - - - - - - - - - Interface TVEITBroadcastedEvent - - - - - - - - -->
    <section>
      <h2><a>TVEITBroadcastedEvent</a> Interface</h2>
      <p>
        The <a>TVEITBroadcastedEvent</a> interface represents the event related
        to the available TV programs in the EIT that is broadcasted by the TV
        source.
      </p>
      <dl title="interface TVEITBroadcastedEvent : Event" class="idl">
        <dt>readonly attribute TVProgram[] programs</dt>
          <dd>
            MUST return the available TV programs in the EIT that is broadcasted
            by the TV source.
          </dd>
      </dl>
    </section>

<!-- - - - - - - - - - Interface TVScanningStateChangedEvent - - - - - - - - -->
    <section>
      <h2><a>TVScanningStateChangedEvent</a> Interface</h2>
      <p>
        The <a>TVScanningStateChangedEvent</a> interface represents the event
        related to the state of scanning the TV channels, which is changed by
        the TV source.
      </p>
      <dl title="interface TVScanningStateChangedEvent : Event" class="idl">
        <dt>readonly attribute TVScanningState state</dt>
          <dd>
            MUST return the state of scanning the TV channels, which is changed
            by the TV source.
          </dd>

        <dt>readonly attribute TVChannel? channel</dt>
           <dd>
            MUST return the TV channel that is scanned by the TV source. MUST
            return <em>null</em> if the <code>state</code> is not specified as
            <code>"scanned"</code>.
           </dd>
      </dl>
    </section>

<!-- - - - - - - - - - - - Interface TVParentalControlChangedEvent - - -->
    <section>
      <h2><a>TVParentalControlChangedEvent</a> Interface</h2>
      <p>
        The <a>TVParentalControlChangedEvent</a> interface represents the
        event related to the state change of the TV parental control.
      </p>
      <dl title="interface TVParentalControlChangedEvent : Event" class="idl">
        <dt>readonly attribute boolean isParentalControlLocked</dt>
          <dd>
            MUST return the changed lock state of the TV parental control.
          </dd>
      </dl>
    </section>

<!-- - - - - - - - Interface TVCurrentChannelChangedEvent - - - - - - - - - -->
    <section>
      <h2><a>TVCurrentChannelChangedEvent</a> Interface</h2>
      <p>
        The <a>TVCurrentChannelChangedEvent</a> interface represents the event
        related to the currently streamed TV channel that is changed by the TV
        tuner.
      </p>
      <dl title="interface TVCurrentChannelChangedEvent : Event" class="idl">
        <dt>readonly attribute TVChannel? channel</dt>
          <dd>
            MUST return the TV channel that is currently streamed by the TV
            tuner. MUST return <em>null</em> if the TV tuner is not streaming
            any TV channel.
          </dd>
      </dl>
    </section>

<!-- - - - - - - - Interface TVCurrentProgramChangedEvent - - - - - - - - - -->
    <section>
      <h2><a>TVCurrentProgramChangedEvent</a> Interface</h2>
      <p>
        The <a>TVCurrentProgramChangedEvent</a> interface represents the event
        related to the currently broadcasted TV program that is changed by the
        TV channel.
      </p>
      <dl title="interface TVCurrentProgramChangedEvent : Event" class="idl">
        <dt>readonly attribute TVProgram? program</dt>
          <dd>
            MUST return the TV program that is currently broadcasted by the TV
            channel. MUST return <em>null</em> if the TV tuner is not streaming
            any TV channel.
          </dd>
      </dl>
    </section>

<!-- - - - - - - - - - - - Interface Enumerations  - - - - - - - - - - - - - -->
    <section>
      <h2>Enumerations</h2>
      <p>
        The attribute <code>type</code> in the <a>TVSource</a> can have the
        following values:
      </p>
      <dl title="enum TVSourceType" class="idl">
        <dt>dvb-t</dt>
          <dd>
            The TV source works for Digital Video Broadcasting - Terrestrial.
          </dd>

        <dt>dvb-c</dt>
          <dd>
            The TV source works for Digital Video Broadcasting - Cable.
          </dd>

        <dt>dvb-s</dt>
          <dd>
            The TV source works for Digital Video Broadcasting - Satellite.
          </dd>
      </dl>

      <p>
        The attribute <code>type</code> in a <a>TVChannel</a> can have the
        following values:
      </p>
      <dl title="enum TVChannelType" class="idl">
        <dt>tv</dt>
          <dd>
            The TV channel is broadcasted as a regular TV type.
          </dd>

        <dt>radio</dt>
          <dd>
            The TV channel is broadcasted as a radio type.
          </dd>

        <dt>data</dt>
          <dd>
            The TV channel is broadcasted as a data type.
          </dd>
      </dl>

      <p>
        The attribute <code>operation</code> in the <a>TVTunerChangedEvent</a>
        can have the following values:
      </p>
      <dl title="enum TVTunerChangedEventOperation" class="idl">
        <dt>added</dt>
          <dd>
            A TV tuner is added.
          </dd>

        <dt>removed</dt>
          <dd>
            A TV tuner is removed.
          </dd>

        <dt>configured</dt>
          <dd>
            A TV tuner is configured.
          </dd>
      </dl>

      <p>
        The attribute <code>state</code> in the
        <a>TVScanningStateChangedEvent</a> can have the following values:
      </p>
      <dl title="enum TVScanningState" class="idl">
        <dt>cleared</dt>
          <dd>
            The state of scanning the TV channels is cleared by the TV source,
            which means all the currently scanned TV channels are cleared before
            scanning.
          </dd>

        <dt>scanned</dt>
          <dd>
            The state of scanning the TV channels is scanned, which means a TV
            channel is successfully scanned by the TV source.
          </dd>

        <dt>completed</dt>
          <dd>
            The state of scanning the TV channels is completed by the TV source.
          </dd>

        <dt>stopped</dt>
          <dd>
            The state of scanning the TV channels is stopped by the TV source.
          </dd>
      </dl>
    </section>

<!-- - - - - - - - - - - - Acknowledgements  - - - - - - - - - - - - - - - - -->
    <section>
      <h2>Acknowledgements</h2>
      <p>
        To be constructed.
      </p>
    </section>

  </body>
</html>
